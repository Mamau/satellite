services:
  - name: "fresh-img"
    command: "pull"
    type: "pull"
    image: "node"
    version: "10"

  - name: "fresh-img-2"
    command: "pull"
    image: "node"
    type: "pull"

  - name: "my-image"
    detach: true
    clean-up: true
    type: "daemon"
    image: "gitlab.com/my/image"
    environment-variables:
      - "PHP_IDE_CONFIG=serverName=192.168.0.1"
    volumes:
      - "$(pwd):/home/www"
    dns:
      - "8.8.8.8"
    ports:
      - "127.0.0.1:443:443"
      - "80:80"

  - name: "my-image-2"
    detach: true
    type: "daemon"
    image: "any-image"
    version: 2
    volumes:
      - "$(pwd):/home/www"

  - name: "composer"
    version: "2"
    user-id: "501"
    image-command: "composer"
    work-dir: "/home/www-data"
    volumes:
      - "$(pwd):/home/www-data"
      - "$(pwd)/cache:/tmp"

  - name: "composer-2"
    version: "1.10"
    user-id: "501"
    image-command: "composer"
    work-dir: "/home/www-data"
    pre-commands:
      - "git config --global http.sslVerify false"
      - "composer config -g http-basic.gitlab.com {GITLAB_USERNAME} {GITLAB_TOKEN}"
    post-commands:
      - "chown -R 501:501 /home/www-data"
    volumes:
      - "$(pwd):/home/www-data"
      - "$(pwd)/cache:/tmp"
